diff --git a/src/transaction/TransactionManager.ts b/src/transaction/TransactionManager.ts
index 6a703ea..e2be5ea 100644
--- a/src/transaction/TransactionManager.ts
+++ b/src/transaction/TransactionManager.ts
@@ -35,11 +35,11 @@ export class TransactionManager {
     this.rolePermissions.set('guest', new Set(['read']));
   }
 
-  createTransaction(userId: string, role: string): Transaction {
+  createTransaction(userId: string, role: string | null): Transaction {
     const transaction: Transaction = {
       id: this.generateId(),
       userId,
-      role,
+      role: role || '',
       operations: [],
       status: TransactionStatus.PENDING,
       createdAt: new Date()
@@ -97,10 +97,13 @@ export class TransactionManager {
     return this.transactions.get(transactionId);
   }
 
-  private hasPermission(role: string, action: string): boolean {
+  private hasPermission(role: string | null, action: string): boolean {
+    if (role === null || role === undefined || (typeof role === 'string' && role.trim() === '')) {
+      return false;
+    }
     const permissions = this.rolePermissions.get(role);
     if (!permissions) {
-      return true;
+      return false;
     }
     return permissions.has(action);
   }
